<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Georgina</title>
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css"/>
  </head>
  <body>
    <div class="container">
      <h1>Georgina</h1>
      <p class="lead">she counts your money</p>

      <div class="row">
        <div id="category-region" class="col-md-3">Transactions</div>
        <div id="main-chart-region" class="col-md-8">This is where the chart goes</div>
        <div id="main-region" class="col-md-8">Static content</div>
      </div>
    </div>

    <script type="text/template" id="transaction-view">
        <div class="panel panel-default">
            <div class="panel-body">
                <table class="table">
                    <tr>
                        ${unescape("<td>Date</td><td><%- date.substring(0, 10) %></td>")}
                    </tr>
                    <tr>
                        ${unescape("<td>Description</td><td><%- description %></td>")}
                    </tr>
                    <tr>
                        ${unescape("<td>Category</td><td><%- category %></td>")}
                    </tr>
                    <tr>
                        ${unescape("<td>Amount</td><td><%- amount %></td>")}
                    </tr>
                </table>
            </div>
        </div>
    </script>

    <script type="text/template" id="category-item">
        ${unescape("<a class='category-js-show' href='categories/<%- category %>'><%-category%></a> (<%- count %>)")}
    </script>

    <script type="text/template" id="transaction-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Category</th>
                <th>Description</th>
                <th>Amount</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </script>

    <script type="text/template" id="transaction-item">
        ${unescape("<td><%- date.substring(0, 10) %></td>")}
        ${unescape("<td><%- category %></td>")}
        ${unescape("<td><%- description.substring(0, 40) %>...</td>")}
        ${unescape("<td><%- amount %></td>")}
        <td><a href="#" class='btn btn-info btn-sm js-show'>
            <i class="icon-zoom-in"></i>More</a>
        </td>
    </script>

    <script type="text/template" id="summary-view">
        <table class="table table-striped">
            <tr>
                <td>Category</td>
                ${unescape("<td><%- category %></td>")}
            </tr>
            <tr>
                <td>Mean</td>
                ${unescape("<td><%- mean %></td>")}
            </tr>
            <tr>
                <td>Count</td>
                ${unescape("<td><%- count %></td>")}
            </tr>
            <tr>
                <td>Standard deviation</td>
                ${unescape("<td><%- standard_deviation %></td>")}
            </tr>
        </table>
    </script>

    <script type="text/template" id="main-chart-view">
        <script type="text/javascript">
            ${unescape("buildMainChart([<%- debits %>]);")}
        </script>
    </script>

    <script type="text/javascript">
        var buildMainChart = function(dataset) {
        //Width and height
        var w = 740;
        var h = 250;

        var xScale = d3.scale.ordinal()
                        .domain(d3.range(dataset.length))
                        .rangeRoundBands([0, w], 0.05);

        var yScale = d3.scale.linear()
                        .domain([0, d3.max(dataset)])
                        .range([0, h]);

        //Create SVG element
        var svg = d3.select("#main-chart-region")
                    .append("svg")
                    .attr("width", w)
                    .attr("height", h);

        //Create bars
        svg.selectAll("rect")
           .data(dataset)
           .enter()
           .append("rect")
           .attr("x", function(d, i) {
                return xScale(i);
           })
           .attr("y", function(d) {
                return h - yScale(d);
           })
           .attr("width", xScale.rangeBand())
           .attr("height", function(d) {
                return yScale(d);
           })
           .attr("fill", "green");

        //Create labels
        svg.selectAll("text")
           .data(dataset)
           .enter()
           .append("text")
           .text(function(d) {
                return d;
           })
           .attr("text-anchor", "middle")
           .attr("x", function(d, i) {
                return xScale(i) + xScale.rangeBand() / 2;
           })
           .attr("y", function(d) {
                return h - yScale(d) + 14;
           })
           .attr("font-family", "sans-serif")
           .attr("font-size", "11px")
           .attr("fill", "white");
        };
        </script>

    <script src="/js/d3.js"></script>
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script src="/js/json2.js"></script>
    <script src="/js/underscore.js"></script>
    <script src="/js/backbone.js"></script>
    <script src="/js/backbone.marionette.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/entities/category.js"></script>
    <script src="/js/entities/summary.js"></script>
    <script src="/js/entities/transaction.js"></script>
    <script src="/js/entities/main_chart.js"></script>
    <script src="/js/apps/transactions/list/list_view.js"></script>
    <script src="/js/apps/transactions/list/list_controller.js"></script>
    <script src="/js/apps/transactions/show/show_controller.js"></script>
    <script src="/js/apps/transactions/show/show_view.js"></script>
    <script src="/js/apps/categories/list/list_view.js"></script>
    <script src="/js/apps/categories/list/list_controller.js"></script>
    <script src="/js/apps/categories/show/show_controller.js"></script>
    <script src="/js/apps/categories/show/show_view.js"></script>
    <script src="/js/apps/main_chart/show/show_controller.js"></script>
    <script src="/js/apps/main_chart/show/show_view.js"></script>
    <script src="/js/index.js"></script>
  </body>
</html>
